# План реализации личной ленты и создания канала

Документ описывает полный план реализации личной ленты (Feed) и функционала создания канала без упрощений. Каждый пункт — отдельная задача для реализации и проверки.

---

## Блок 0. Дополнительные настройки на /profile

- [ ] **0.1** На странице `/profile` добавить раздел «Дополнительные настройки».
- [ ] **0.2** Пункт «Создать канал» — переход на экран/маршрут создания канала (форма: название, описание, аватар, тип канала).
- [ ] **0.3** Пункт «Личная лента» / «Перейти в ленту» — переход в раздел ленты (маршрут `/feed` или аналог).

---

## 1. Структура интерфейса личной ленты

### 1.1 Основная лента (Feed)

- [ ] **1.1.1** Экран основной ленты показывает посты, фотографии и видео.
- [ ] **1.1.2** Пользователи могут лайкать посты.
- [ ] **1.1.3** Пользователи могут комментировать посты.
- [ ] **1.1.4** Пользователи могут делиться постами.
- [ ] **1.1.5** Отображение поста:
  - [ ] Фотографии и видео с возможностью увеличения изображения при нажатии (fullscreen/lightbox).
  - [ ] Под каждой публикацией — количество лайков.
  - [ ] Кнопка комментирования (иконка + счётчик комментариев).
  - [ ] Кнопка «Поделиться» с возможностью отправить в чат (выбор чата из списка).
  - [ ] Логотип (аватар) и имя пользователя, который опубликовал пост.
- [ ] **1.1.6** Навигация внизу экрана — панель с иконками:
  - [ ] Домой (Feed) — главная лента.
  - [ ] Поиск — страница поиска.
  - [ ] Создать пост — экран создания поста.
  - [ ] Уведомления — экран уведомлений.
  - [ ] Профиль пользователя — профиль текущего пользователя в контексте ленты.

### 1.2 Профиль пользователя (в ленте)

- [ ] **1.2.1** Header: фото профиля, имя пользователя.
- [ ] **1.2.2** Счётчик подписчиков и подписок.
- [ ] **1.2.3** Кнопка «Подписаться» или «Отписаться» в зависимости от состояния.
- [ ] **1.2.4** Галерея публикаций: сетка из постов пользователя.
- [ ] **1.2.5** В каждой картинке в сетке отображаются лайки, комментарии и возможность открыть полную версию фото/видео.
- [ ] **1.2.6** Возможность добавлять новый пост (кнопка «Добавить пост») — для своего профиля.

### 1.3 Экран поста

- [ ] **1.3.1** Подробное отображение поста с видео или фото.
- [ ] **1.3.2** Возможность добавлять комментарии.
- [ ] **1.3.3** Кнопка лайка/дизлайка.
- [ ] **1.3.4** Возможность помечать комментарии как «важные» или «спам» (для автора поста/модерации).
- [ ] **1.3.5** Переключение между видами контента: изображения, видео, карусели (если пост содержит несколько медиа).

---

## 2. Регистрация, авторизация и аутентификация

- [ ] **2.1** Регистрация через телефон (существующий поток — расширить при необходимости).
- [ ] **2.2** Регистрация через почту (форма email + пароль/код подтверждения).
- [ ] **2.3** Регистрация/вход через социальные сети (OAuth: VK, Google, и т.д. — по выбору).
- [ ] **2.4** Аутентификация через Telegram-бота для авторизации (ссылка/кнопка «Войти через Telegram», передача данных пользователя боту и получение токена/сессии).
- [ ] **2.5** Единый механизм хранения сессии/токена после любого способа входа.
- [ ] **2.6** Восстановление пароля / смена привязки телефона/почты (по ТЗ при наличии).

---

## 3. Создание поста

- [ ] **3.1** При нажатии «Создать пост» пользователь получает выбор: фото или видео (выбор типа или мультивыбор медиа).
- [ ] **3.2** Подпись к публикации (текстовое поле), включая поддержку хештегов (парсинг #tag, кликабельные ссылки на ленту по хештегу).
- [ ] **3.3** Опция добавления геолокации (кнопка «Добавить место», выбор на карте или поиск места, сохранение координат/названия).
- [ ] **3.4** Выбор видимости: «Сделать пост публичным» или «Только для подписчиков».
- [ ] **3.5** Поддержка форматов медиа: JPG, PNG, GIF, MP4 и др. (валидация на клиенте и бэкенде).
- [ ] **3.6** Возможность добавлять теги пользователей в описание поста через @имя (автодополнение по списку подписок/друзей, сохранение ссылок на userId).
- [ ] **3.7** Карусель: несколько фото/видео в одном посте (слайдер при просмотре).
- [ ] **3.8** Превью перед публикацией и кнопка «Опубликовать».

---

## 4. Поиск и фильтры

- [ ] **4.1** Страница поиска: поле ввода с автодополнением.
- [ ] **4.2** Поиск по имени пользователя (API + отображение списка пользователей).
- [ ] **4.3** Поиск по хештегам (API + отображение постов с данным хештегом).
- [ ] **4.4** Рекомендуемые аккаунты (блок на странице поиска, источник — API рекомендаций).
- [ ] **4.5** Популярные публикации (блок/вклад с постами по популярности).
- [ ] **4.6** Фильтр постов по категории: популярные, новые, тренды (переключатель или табы).
- [ ] **4.7** Реализация «свайпа» (как в Instagram Stories) по лентам разных категорий (горизонтальный свайп между категориями или вертикальный между постами).

---

## 5. Комментарии и взаимодействие с пользователями

- [ ] **5.1** Пользователи могут комментировать посты (поле ввода + отправка, отображение списка комментариев).
- [ ] **5.2** Возможность оставлять лайк на комментарий (иконка + счётчик).
- [ ] **5.3** Система уведомлений о новых комментариях на постах (push/внутриприложенные, см. п. 6).
- [ ] **5.4** Функционал «Ответить» на комментарий с отображением вложенных сообщений (древовидная или плоская структура с parentId).
- [ ] **5.5** Возможность удалять комментарии (свои; для автора поста — любые в посте).
- [ ] **5.6** Возможность блокировать пользователей (скрытие комментариев, запрет комментирования, скрытие из ленты — по политике продукта).

---

## 6. Уведомления

- [ ] **6.1** Уведомления о новых лайках (на постах и комментариях).
- [ ] **6.2** Уведомления о новых комментариях на постах.
- [ ] **6.3** Уведомления о новых подписках (кто-то подписался на пользователя).
- [ ] **6.4** Уведомления о новых постах в ленте (от подписок) — опционально, по настройкам.
- [ ] **6.5** Уведомления о значимых событиях: добавление в друзья, предложенные посты (если есть модель «друзья» и рекомендации).
- [ ] **6.6** Экран списка уведомлений с фильтрами/группировкой и отметкой прочитано.
- [ ] **6.7** Push-уведомления (интеграция с FCM/Web Push) и настройки включения/отключения по типам.

---

## 7. Система подписок и рекомендаций

- [ ] **7.1** Реализация подписки на пользователя (кнопка «Подписаться», сохранение связи подписчик — автор).
- [ ] **7.2** Реализация отписки («Отписаться»).
- [ ] **7.3** Отображение счётчиков подписчиков и подписок в профиле.
- [ ] **7.4** Алгоритмы рекомендаций: рекомендуемые посты (на основе интересов, активности, трендов).
- [ ] **7.5** Рекомендации пользователей «кого подписать» (на основе интересов, общих подписок, активности).
- [ ] **7.6** Лента постов: показ постов только от подписок (или смесь подписки + рекомендации — по продукту).

---

## 8. Реализация Stories (Историй)

- [ ] **8.1** Истории — временные публикации (срок жизни 24 часа с момента публикации).
- [ ] **8.2** В верхней части экрана ленты отображаются иконки пользователей, у которых есть новые истории (горизонтальный скролл).
- [ ] **8.3** При тапе на иконку — просмотр историй пользователя (слайды фото/видео, таймер или автопереход).
- [ ] **8.4** Истории исчезают через 24 часа (удаление на бэкенде или скрытие по времени).
- [ ] **8.5** Возможность отвечать на историю (отправка сообщения автору или ответ в формате «reply to story»).
- [ ] **8.6** Возможность ставить лайк на историю.
- [ ] **8.7** Возможность делиться историей (отправка ссылки/превью в чат или соцсети).
- [ ] **8.8** Создание истории: добавление фото или видео; возможность добавлять текст, гифки и фильтры (наложение текста, стикеры, фильтры изображения).
- [ ] **8.9** Модель данных: автор, дата создания, контент (медиа), длительность отображения, список просмотров (опционально).

---

## 9. Безопасность и конфиденциальность

- [ ] **9.1** Защита данных пользователя (HTTPS, безопасное хранение токенов, политика паролей).
- [ ] **9.2** Шифрование личных сообщений (e2ee — end-to-end encryption для чатов, ключи на клиенте, сервер хранит только зашифрованный контент).
- [ ] **9.3** Настройки конфиденциальности для каждого поста: кто может видеть пост — только подписчики, друзья, публично (выбор при создании и возможность изменить позже).
- [ ] **9.4** Настройки приватности профиля (закрытый аккаунт, кто может комментировать, кто может тегать).
- [ ] **9.5** Модерация контента и жалобы (кнопка «Пожаловаться», пометка «спам»/«важно» для комментариев, см. п. 1.3.4).

---

## 10. Backend-логика

### 10.1 Модели данных

- [ ] **10.1.1** Посты: id, автор (userId), изображения/видео (URL или массив медиа), описание, дата создания, лайки (счётчик + список userId для проверки «лайкнул ли я»), комментарии (счётчик, отдельная коллекция).
- [ ] **10.1.2** Пользователи: профиль (имя, username, аватар, био, email, дата рождения и т.д.), подписки (список подписок/подписчиков), лайки, комментарии, настройки уведомлений.
- [ ] **10.1.3** Комментарии: id, текст, дата, автор (userId), пост (postId), parentId (для ответов), лайки, флаги (важный, спам).
- [ ] **10.1.4** Истории: id, автор, дата создания, контент (медиа), длительность отображения, срок истечения (createdAt + 24h).
- [ ] **10.1.5** Уведомления: id, тип (like, comment, subscribe, …), получатель, отправитель, ссылка на объект (postId, commentId), прочитано, дата.
- [ ] **10.1.6** Подписки: подписчик (userId), автор (userId), дата.

### 10.2 API

- [ ] **10.2.1** REST API (или GraphQL) для ленты: получение постов (лента), поста по id, постов пользователя.
- [ ] **10.2.2** API для комментариев: список, создание, удаление, лайк.
- [ ] **10.2.3** API для лайков постов и комментариев: поставить/снять.
- [ ] **10.2.4** API подписок: подписаться, отписаться, список подписок/подписчиков.
- [ ] **10.2.5** API уведомлений: список, отметка прочитано.
- [ ] **10.2.6** API создания поста: загрузка медиа, сохранение метаданных, описание, геолокация, видимость, теги.
- [ ] **10.2.7** API историй: создание, получение списка по пользователям, истечение по времени.
- [ ] **10.2.8** API поиска: по пользователям, по хештегам, рекомендуемые аккаунты/посты.
- [ ] **10.2.9** Пагинация ленты: бесконечная прокрутка (cursor/offset + limit), подгрузка при скролле.
- [ ] **10.2.10** Индикаторы загрузки на экранах ленты, поста и историй (скелетоны, спиннеры).

---

## 11. Мобильные особенности

- [ ] **11.1** Адаптивный интерфейс для мобильных устройств (breakpoints, touch-friendly кнопки, читаемые шрифты).
- [ ] **11.2** Жесты: свайпы для переключения между постами (вертикально) и между историями/категориями (горизонтально).
- [ ] **11.3** Загрузка фотографий и видео с устройства (input file, capture=camera для мобильных).
- [ ] **11.4** Обработка видеозвонков и сообщений с уведомлениями (интеграция с существующим чатом/звонками).
- [ ] **11.5** Поддержка pull-to-refresh для ленты и списков.

---

## 12. Дополнительные функции

- [ ] **12.1** Магазины и реклама: посты с рекламой или товарами (метка «Реклама», ссылка на товар/магазин).
- [ ] **12.2** Интеграция с оплатой (оплата подписки на эксклюзивный контент, донаты, товары).
- [ ] **12.3** Монетизация: платные подписки на контент пользователя, доступ к отдельным постам/разделам по подписке.
- [ ] **12.4** Аналитика для авторов: просмотры, охват, статистика по постам и историям.

---

## Создание канала (отдельный блок)

- [ ] **C.1** Экран/форма «Создать канал»: название, описание, аватар канала, тип (публичный/приватный).
- [ ] **C.2** После создания — переход в канал (чат канала или лента канала, в зависимости от продукта).
- [ ] **C.3** Связь канала с учётной записью пользователя (владелец/админ).
- [ ] **C.4** API создания канала и сохранение в общую модель чатов/каналов.

---

## Порядок проверки

1. Реализовать пункты блока 0 (профиль: ссылки на канал и ленту).
2. Реализовать типы данных и API (п. 10), затем подключить к клиенту.
3. Реализовать структуру интерфейса (п. 1): экраны, навигация, отображение поста и профиля.
4. Реализовать создание поста (п. 3), комментарии (п. 5), лайки и подписки (п. 7).
5. Реализовать поиск и фильтры (п. 4), уведомления (п. 6), истории (п. 8).
6. Подключить авторизацию по ТЗ (п. 2), безопасность и конфиденциальность (п. 9).
7. Адаптив и жесты (п. 11), дополнительные функции (п. 12) и создание канала (C.1–C.4).

Ничего не пропускать, ничего не упрощать: каждый чекбокс — отдельная проверяемая задача.
