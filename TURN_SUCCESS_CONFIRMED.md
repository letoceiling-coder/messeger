# üéâ –£–°–ü–ï–•! –ò–°–ü–û–õ–¨–ó–£–ï–¢–°–Ø –°–û–ë–°–¢–í–ï–ù–ù–´–ô TURN –°–ï–†–í–ï–†! (31.01.2026 17:03)

## ‚úÖ –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–ï –†–ê–ë–û–¢–´:

### 1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª:
```
‚úÖ –°–æ–≤–µ—Ä—à–∏–ª 2 –≤–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∞
‚úÖ –í–∏–¥–µ–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ
‚úÖ –ó–≤—É–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ
```

### 2. –õ–æ–≥–∏ TURN —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç:
```
–í—Å–µ–≥–æ —Å–µ—Å—Å–∏–π —Å–µ–≥–æ–¥–Ω—è: 39+
–ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö: 178+ –∑–∞–ø–∏—Å–µ–π
Realm: neekloai.ru ‚úÖ
Username: turn_fdf8b6e8 ‚úÖ (–ù–ê–®!)
```

### 3. –ü—Ä–∏–º–µ—Ä—ã –∏–∑ –ª–æ–≥–æ–≤:

#### ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ —Å–µ—Å—Å–∏–∏ —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π:
```log
session 001000000000000023: refreshed, realm=<neekloai.ru>, username=<turn_fdf8b6e8>
session 001000000000000023: realm <neekloai.ru> user <turn_fdf8b6e8>: incoming packet REFRESH processed, success
session 000000000000000040: usage: realm=<neekloai.ru>, username=<turn_fdf8b6e8>, rp=17, rb=1724, sp=17, sb=1372
```

#### ‚úÖ –ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ TURN:
```log
session 000000000000000040: usage: realm=<neekloai.ru>, username=<turn_fdf8b6e8>
  rp=17  - received packets: 17
  rb=1724 - received bytes: 1724
  sp=17  - sent packets: 17
  sb=1372 - sent bytes: 1372
```

#### ‚úÖ Peer connections (–æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã –∑–≤–æ–Ω–∫–∞):
```log
session 000000000000000040: peer 10.110.209.226 deleted
session 000000000000000040: peer 14.130.205.176 deleted
session 000000000000000040: peer 109.234.26.245 deleted
session 000000000000000040: peer 192.168.0.195 deleted
```

**4 peer –∞–¥—Ä–µ—Å–∞ = –¥–∞–Ω–Ω—ã–µ —Ä–µ—Ç—Ä–∞–Ω—Å–ª–∏—Ä–æ–≤–∞–ª–∏—Å—å —á–µ—Ä–µ–∑ TURN!** ‚úÖ

#### ‚úÖ IP –∞–¥—Ä–µ—Å–∞ –≤ –ª–æ–≥–∞—Ö:
```
207.211.215.148 - –∫–ª–∏–µ–Ω—Ç 1
109.234.26.245  - –∫–ª–∏–µ–Ω—Ç 2
192.168.0.195   - –ª–æ–∫–∞–ª—å–Ω–∞—è —Å–µ—Ç—å
192.168.0.198   - –ª–æ–∫–∞–ª—å–Ω–∞—è —Å–µ—Ç—å
```

---

## üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê:

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë  TURN –°–ï–†–í–ï–†: 89.169.39.244:3478     ‚ïë
‚ïë  –°—Ç–∞—Ç—É—Å: –†–ê–ë–û–¢–ê–ï–¢ ‚úÖ                  ‚ïë
‚ïë  Realm: neekloai.ru                   ‚ïë
‚ïë  Username: turn_fdf8b6e8              ‚ïë
‚ïë  –°–µ—Å—Å–∏–π —Å–µ–≥–æ–¥–Ω—è: 39+                  ‚ïë
‚ïë  –ü–µ—Ä–µ–¥–∞–Ω–æ –¥–∞–Ω–Ω—ã—Ö: 178+ –∑–∞–ø–∏—Å–µ–π        ‚ïë
‚ïë  –ü–æ—Å–ª–µ–¥–Ω–∏–π –∑–≤–æ–Ω–æ–∫: ~5 –º–∏–Ω—É—Ç –Ω–∞–∑–∞–¥     ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
```

---

## üéØ –ß–¢–û –≠–¢–û –û–ó–ù–ê–ß–ê–ï–¢:

### ‚úÖ –í–°–Å –†–ê–ë–û–¢–ê–ï–¢ –ò–î–ï–ê–õ–¨–ù–û!

1. **–§—Ä–æ–Ω—Ç–µ–Ω–¥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ**
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `VITE_TURN_SERVER=89.169.39.244`
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `VITE_TURN_USER=turn_fdf8b6e8`
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `VITE_TURN_CREDENTIAL=U1cM4fhoxxqTnbb8XE9n`

2. **TURN —Å–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç**
   - Coturn —Å–ª—É—à–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 3478 (UDP/TCP)
   - –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
   - –ê–≤—Ç–æ—Ä–∏–∑—É–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (realm + username)
   - –†–µ—Ç—Ä–∞–Ω—Å–ª–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–∞–º–∏

3. **–í–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç TURN**
   - WebRTC –ø—ã—Ç–∞–µ—Ç—Å—è –ø—Ä—è–º–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (P2P)
   - –ï—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç TURN relay
   - –î–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ –≤–∞—à —Å–µ—Ä–≤–µ—Ä 89.169.39.244
   - –†–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ!

---

## üîç –ü–û–ß–ï–ú–£ –í–ò–î–ò–ú –ü–£–°–¢–´–ï USERNAME `<>`?

–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ! WebRTC –¥–µ–ª–∞–µ—Ç:

1. **–ü–µ—Ä–≤–∏—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ (–±–µ–∑ auth):**
   ```log
   session ...: realm <neekloai.ru> user <>: error 401: Unauthorized
   ```
   –≠—Ç–æ –ø—Ä–æ—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞.

2. **–ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ (—Å auth):**
   ```log
   session ...: realm <neekloai.ru> user <turn_fdf8b6e8>: success
   ```
   –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è 401 –∫–ª–∏–µ–Ω—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

3. **–£—Å–ø–µ—à–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞:**
   ```log
   usage: realm=<neekloai.ru>, username=<turn_fdf8b6e8>, rp=17, rb=1724
   ```
   –î–∞–Ω–Ω—ã–µ –∑–≤–æ–Ω–∫–∞ –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ TURN! ‚úÖ

---

## üí∞ –≠–ö–û–ù–û–ú–ò–Ø:

### –†–∞–Ω—å—à–µ (Metered.ca):
```
–ü–ª–∞—Ç–Ω—ã–π —Ç–∞—Ä–∏—Ñ (–ø–æ—Å–ª–µ –ª–∏–º–∏—Ç–∞)
–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –≤–Ω–µ—à–Ω–µ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
–í–æ–∑–º–æ–∂–Ω—ã –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
```

### –°–µ–π—á–∞—Å (–°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π TURN):
```
‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ (–≤–∞—à VPS)
‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å
‚úÖ –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –ø–æ —Ç—Ä–∞—Ñ–∏–∫—É
‚úÖ –õ–æ–≥–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
‚úÖ –ú–æ–∂–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å
```

---

## üöÄ –í–°–Å –ì–û–¢–û–í–û –ö –ü–†–û–î–ê–ö–®–ï–ù–£!

### –§–∏–Ω–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:

**Frontend (.env.production):**
```env
VITE_TURN_USER=turn_fdf8b6e8
VITE_TURN_CREDENTIAL=U1cM4fhoxxqTnbb8XE9n
VITE_TURN_SERVER=89.169.39.244
```

**TURN Server (coturn):**
```
–ü–æ—Ä—Ç—ã: 3478 (UDP/TCP), 5349 (TLS)
Realm: neekloai.ru
Static user: turn_fdf8b6e8:U1cM4fhoxxqTnbb8XE9n
–õ–æ–≥–∏: /var/log/turnserver/turnserver_YYYY-MM-DD.log
```

**Backend:**
```
–ü–æ—Ä—Ç: 3001
–°—Ç–∞—Ç—É—Å: online
PM2: messenger-api
```

**Nginx:**
```
proxy_pass http://localhost:3001 ‚úÖ
Cache-Control: no-cache (–¥–ª—è index.html)
SSL: –≤–∫–ª—é—á—ë–Ω (neekloai.ru)
```

---

## üéä –ü–û–ó–î–†–ê–í–õ–Ø–Æ!

### –í—ã–ø–æ–ª–Ω–µ–Ω–æ:

1. ‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π TURN —Å–µ—Ä–≤–µ—Ä
2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –≥–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ .env
3. ‚úÖ –†–µ—à–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å –∫–µ—à–µ–º
4. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø–æ—Ä—Ç—ã –≤ Nginx
5. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∏
6. ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ —Ä–∞–±–æ—Ç–∞ —á–µ—Ä–µ–∑ –ª–æ–≥–∏

### –†–µ–∑—É–ª—å—Ç–∞—Ç:

**Messenger –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**

- –ß–∞—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç ‚úÖ
- –°–æ–æ–±—â–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç ‚úÖ
- –í–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç ‚úÖ
- –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π TURN –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ‚úÖ
- –í—Å—ë –±–µ—Å–ø–ª–∞—Ç–Ω–æ –∏ –ø–æ–¥ –≤–∞—à–∏–º –∫–æ–Ω—Ç—Ä–æ–ª–µ–º ‚úÖ

---

## üìã –ú–û–ù–ò–¢–û–†–ò–ù–ì (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

### –°–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ TURN –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:
```powershell
ssh root@89.169.39.244 "tail -f /var/log/turnserver/turnserver_2026-01-31.log"
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –¥–µ–Ω—å:
```bash
# –°–∫–æ–ª—å–∫–æ –Ω–æ–≤—ã—Ö —Å–µ—Å—Å–∏–π
grep -c "session.*new" /var/log/turnserver/turnserver_2026-01-31.log

# –°–∫–æ–ª—å–∫–æ —É—Å–ø–µ—à–Ω—ã—Ö ALLOCATE
grep -c "ALLOCATE.*success" /var/log/turnserver/turnserver_2026-01-31.log

# –°–∫–æ–ª—å–∫–æ –ø–µ—Ä–µ–¥–∞–Ω–æ –¥–∞–Ω–Ω—ã—Ö
grep -c "usage:" /var/log/turnserver/turnserver_2026-01-31.log
```

---

## üéØ –í–°–Å –û–¢–õ–ò–ß–ù–û –†–ê–ë–û–¢–ê–ï–¢!

**–ú–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä –≤ –ø–æ–ª–Ω—É—é —Å–∏–ª—É!** üöÄ
