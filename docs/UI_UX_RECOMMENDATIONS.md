# Рекомендации по улучшению интерфейса и функционала Messager

Документ дополняет [PLAN_MESSENGER_IMPROVEMENTS.md](./PLAN_MESSENGER_IMPROVEMENTS.md). **Рекомендации из этого файла внесены в план в правильной последовательности реализации** — см. разделы «Порядок реализации (сводка)», «Этап 0», этапы 1, 5, 9, 11, 12 и 13 в PLAN_MESSENGER_IMPROVEMENTS.md. Ниже — справочное описание идей по UX, визуальной согласованности и доступности.

---

## 1. Связь с существующим планом

- **Функциональные доработки** (панель в стиле Telegram, эмодзи, вложения, ответ/пересылка, настройки, звонки) — см. **PLAN_MESSENGER_IMPROVEMENTS.md**.
- Ниже — **рекомендации**, которые можно делать параллельно или после этапов плана: единый стиль, доступность, пустые состояния, быстрые победы.

---

## 2. Визуальная согласованность

| Рекомендация | Описание | Приоритет |
|--------------|----------|-----------|
| **Единая тема входа/регистрации** | Сейчас чаты и список — тёмная тема (`#0b0b0b`, `#2d2d2f`), а страницы входа и регистрации — светлые (`bg-gray-50`, `text-gray-900`). Сделать Login/Register в той же тёмной палитре, чтобы переход в приложение не был резким. | Высокий |
| **Общие токены цветов** | Вынести цвета в переменные (CSS или Tailwind theme): фон, акцент (`#0a84ff`), текст, вторичный текст (`#86868a`), границы. Использовать везде одни и те же значения. | Средний |
| **Иконки и кнопки** | Единый размер иконок (например 20×20 / 24×24), одинаковые отступы у кнопок, один стиль скругления (например `rounded-xl` в списке чатов и в поле ввода). | Средний |

---

## 3. Пустые состояния и загрузка

| Рекомендация | Описание | Приоритет |
|--------------|----------|-----------|
| **Пустой чат** | При отсутствии сообщений показывать короткий текст («Начните переписку» или «Отправьте первое сообщение») и, при желании, подсказку по действиям (эмодзи, вложения, звонок). | Высокий |
| **Поиск без результатов** | Уже есть «Никого не найдено»; можно добавить подсказку («Попробуйте другой запрос» или «Пользователь должен быть зарегистрирован»). | Низкий |
| **Скелетоны вместо «Загрузка...»** | На списке чатов и в чате вместо одного слова «Загрузка...» — скелетоны (прямоугольники по форме аватаров и строк), чтобы интерфейс не «прыгал». | Средний |
| **Состояние ошибки загрузки** | Если не удалось загрузить чат или сообщения — кнопка «Повторить» и короткое сообщение об ошибке вместо пустого экрана. | Высокий |

---

## 4. Доступность (a11y)

| Рекомендация | Описание | Приоритет |
|--------------|----------|-----------|
| **Фокус и навигация с клавиатуры** | Проверить, что все интерактивные элементы доступны с Tab, что фокус виден (например `ring-2 ring-[#0a84ff]`) и не теряется в модалках. | Высокий |
| **Семантика и ARIA** | У списка чатов — роль `list`/`listitem`, у области сообщений — `region` с `aria-label`. Кнопки без текста — обязательно `aria-label` (у части кнопок уже есть). | Средний |
| **Контраст** | Проверить контраст текста `#86868a` на фоне `#0b0b0b` / `#2d2d2f` (WCAG AA). При необходимости чуть осветлить вторичный текст. | Средний |
| **Масштабирование** | Убедиться, что при увеличении шрифта (настройки ОС/браузера) интерфейс не ломается: не обрезать подпись, не наезжать кнопки. | Низкий |

---

## 5. Удобство ввода и навигации

| Рекомендация | Описание | Приоритет |
|--------------|----------|-----------|
| **Многострочный ввод** | В плане уже есть замена `input` на `textarea` с авторостом. Это сильно улучшает UX при длинных сообщениях. | Высокий (в плане) |
| **Enter — отправка, Shift+Enter — новая строка** | Один из привычных сценариев в мессенджерах; при введении textarea логику можно задать так. | Средний |
| **Горячие клавиши (десктоп)** | Например: фокус в поле ввода при открытии чата; Escape — закрыть модалку/эмодзи/входящий звонок. Опционально: Ctrl+K — поиск чата. | Низкий |
| **Кнопка «Назад» в чате** | На мобильной ширине явная кнопка «Назад» в шапке чата (или стрелка влево) улучшает навигацию. | Средний |

---

## 6. Обратная связь и устойчивость к ошибкам

| Рекомендация | Описание | Приоритет |
|--------------|----------|-----------|
| **Тост вместо alert** | Заменить `alert(...)` на небольшие тосты (внизу или сверху экрана), чтобы не блокировать интерфейс. Можно простой компонент + контекст. | Высокий |
| **Повтор при сбое отправки** | Если сообщение не отправилось (сеть/ошибка сервера), показывать «Не удалось отправить. Повторить?» рядом с сообщением или в тосте. | Высокий |
| **Индикатор подключения** | Уже есть `ConnectionBanner` — хорошо. Можно дополнительно показывать в шапке чата или списка чатов маленький индикатор (зелёный/серый) «В сети» / «Переподключение». | Низкий |
| **Оптимистичное обновление** | При отправке сообщения сразу показывать его в чате со статусом «отправляется» и затем менять на «доставлено»/«прочитано» — это уже частично есть; проверить согласованность при ошибке. | Средний |

---

## 7. Список чатов

| Рекомендация | Описание | Приоритет |
|--------------|----------|-----------|
| **Поиск по чатам** | Поле поиска над списком: фильтр по имени контакта/чата без перехода в «Новый чат». Удобно при большом количестве чатов. | Средний |
| **Свайп по чату (мобильный веб)** | Свайп влево — «Пометить прочитанным» / «Скрыть уведомления» / «Удалить чат» (по желанию). | Низкий |
| **Страница настроек вместо только «Выйти»** | Вынести «Выйти» в отдельную страницу «Настройки» вместе с профилем, уведомлениями и т.д. — см. план, этап 6. | Высокий (в плане) |
| **Десктоп: список слева, чат справа** | На широком экране показывать список чатов слева и открытый чат справа без перехода на отдельный «экран» — см. план, этап 5. | Средний (в плане) |

---

## 8. Чат и сообщения

| Рекомендация | Описание | Приоритет |
|--------------|----------|-----------|
| **Разделители дат** | В ленте сообщений вставлять подпись «Сегодня», «Вчера», «15 января» между блоками сообщений по дате. | Средний |
| **Прокрутка к новому сообщению** | При получении нового сообщения плавно прокручивать вниз (или показывать кнопку «N новых»), если пользователь уже внизу. Сейчас есть `scrollToBottom` — проверить поведение на мобильных. | Средний |
| **Долгое нажатие — меню** | Контекстное меню «Ответить / Переслать / Удалить» по долгому нажатию — в плане (этап 10). Важно для мобильного. | Высокий (в плане) |
| **Превью ссылок** | Для сообщений, содержащих URL, показывать превью (title, description, картинка) — опционально, средний приоритет. | Низкий |

---

## 9. Звонки

| Рекомендация | Описание | Приоритет |
|--------------|----------|-----------|
| **Явные состояния** | «Звоним…», «Соединяемся…», «Завершён» — в плане (этап 9). Доработать отображение в UI. | Высокий (в плане) |
| **Вибрация/звук при входящем** | На мобильном — короткая вибрация при входящем звонке; звук уже есть. | Средний |
| **Кнопка отклонить крупнее** | На экране входящего звонка кнопка «Отклонить» часто красная и более заметная — снижает случайные принятия. | Низкий |

---

## 10. Первый запуск и онбординг

| Рекомендация | Описание | Приоритет |
|--------------|----------|-----------|
| **Краткий онбординг** | После первого входа — 1–2 экрана: «Добавьте контакт и начните чат» или «Нажмите + для нового чата». Можно закрывать по кнопке «Понятно». | Низкий |
| **Подсказки при первом действии** | Например, при первом открытии чата — тултип «Здесь можно писать сообщения и звонить» (один раз, флаг в localStorage). | Низкий |

---

## 11. Производительность и технические улучшения

| Рекомендация | Описание | Приоритет |
|--------------|----------|-----------|
| **Виртуализация списка сообщений** | При большом количестве сообщений (100+) рендерить только видимую область (react-window / react-virtuoso), чтобы не тормозил скролл. | Средний |
| **Ленивая загрузка медиа** | Изображения и видео в сообщениях — с `loading="lazy"` и при необходимости placeholder до загрузки. | Средний |
| **Дебаунс поиска** | Поиск пользователей уже с задержкой 300 ms — хорошо; при добавлении поиска по чатам — такой же дебаунс. | — |

---

## 12. Мобильное приложение (React Native / Expo)

| Рекомендация | Описание | Приоритет |
|--------------|----------|-----------|
| **Жесты** | Свайп назад для выхода из чата; при необходимости свайп по сообщению для ответа/удаления. | Средний |
| **Safe Area** | Учитывать вырезы и индикатор домашней строки (SafeAreaView / insets). | Высокий |
| **Клавиатура** | При открытии поля ввода поднимать панель ввода вместе с клавиатурой (KeyboardAvoidingView или поведение из навигации). | Высокий |
| **Haptic feedback** | Лёгкая вибрация при нажатии кнопок (отправка, ответ на звонок) — опционально. | Низкий |

---

## 13. Приоритизация: с чего начать

**Быстрые победы (1–2 дня):**

1. Привести страницы входа и регистрации к тёмной теме приложения.
2. Заменить `alert` на тосты (простой Toast-компонент + контекст).
3. Пустое состояние в чате: «Начните переписку» при отсутствии сообщений.
4. Обработка ошибки загрузки чата/сообщений с кнопкой «Повторить».

**Средний приоритет (по плану и дополнениям):**

5. Скелетоны загрузки на списке чатов и в чате.
6. Поиск по чатам на главной.
7. Разделители дат в ленте сообщений.
8. Единые токены цветов (переменные CSS/Tailwind).
9. Проверка фокуса и клавиатурной навигации (a11y).

**Долгосрочно / по желанию:**

10. Виртуализация списка сообщений.
11. Превью ссылок в сообщениях.
12. Небольшой онбординг при первом входе.
13. Горячие клавиши на десктопе.

---

## 14. Итог

- **Единый план реализации** — в **PLAN_MESSENGER_IMPROVEMENTS.md**: там перечислены все этапы (0–13) в правильной последовательности, включая интеграцию рекомендаций из этого документа.
- **Этот документ** — справочник идей по UX и интерфейсу; для порядка выполнения используйте раздел «Порядок реализации (сводка)» и этапы 0, 1, 5, 9, 11, 12, 13 в плане.
