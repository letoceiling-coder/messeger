# SMSC.ru — настройка выполнена

## Результаты

### ✅ Подключение SSH
- `ssh root@89.169.39.244` — работает (ключевая аутентификация)

### ✅ Отправка SMS локально
```
Отправка SMS на: 89897625658 → нормализован: 79897625658
SMS отправлено успешно: { id: 1, cnt: 1 }
```

### ⚠️ Отправка с сервера
- Ошибка SMSC: `no money` (error_code: 3) — недостаточно средств на балансе SMSC
- Учётные данные настроены корректно
- **Решение:** пополните баланс в [личном кабинете SMSC](https://smsc.ru/)

---

## Формат номера (маска → SMSC)

| Ввод (маска AuthPage) | Нормализован для API | SMSC принимает |
|-----------------------|----------------------|----------------|
| +7 (989) 762-56-58    | +79897625658         | 79897625658    |
| 89897625658           | 79897625658          | 79897625658    |
| 9991234567            | 79991234567          | 79991234567    |

**Правило:** берём последние 10 цифр и добавляем `7` в начало → `7XXXXXXXXXX`.

---

## На сервере настроено

- `/var/www/messager/backend/.env` — добавлены `SMSC_LOGIN`, `SMSC_PASSWORD`
- `/var/www/messager/backend/scripts/send-test-sms.cjs` — скрипт тестовой отправки
- `/var/www/messager/backend/src/smsc/` — модуль SMSC

**Повторная отправка после пополнения баланса:**
```bash
ssh root@89.169.39.244 "cd /var/www/messager/backend && node scripts/send-test-sms.cjs 89897625658 'Ваше сообщение'"
```

---

## Локальный запуск

```powershell
cd backend
$env:SMSC_LOGIN="dsc-23"; $env:SMSC_PASSWORD="ваш_пароль"
node scripts/send-test-sms.cjs 89897625658 "Текст SMS"
```

Или через `.env` в `backend/`:
```
SMSC_LOGIN=dsc-23
SMSC_PASSWORD=ваш_пароль
```
