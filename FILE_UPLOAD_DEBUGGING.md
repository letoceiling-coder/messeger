# üîç –û–¢–õ–ê–î–ö–ê –ó–ê–ì–†–£–ó–ö–ò –§–ê–ô–õ–û–í (31.01.2026 20:15)

## üêõ –¢–ï–ö–£–©–ê–Ø –ü–†–û–ë–õ–ï–ú–ê:

–§–∞–π–ª—ã (–∞—É–¥–∏–æ, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –≤–∏–¥–µ–æ) –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è, –Ω–æ –ø–æ–ª—É—á–∞—é—Ç **404 –æ—à–∏–±–∫—É**:
```
GET https://neekloai.ru/uploads/audio/voice-*.webm 404 (Not Found)
GET https://neekloai.ru/uploads/images/img-*.jpg 404 (Not Found)
GET https://neekloai.ru/uploads/videos/vid-*.mp4 404 (Not Found)
```

## ‚úÖ –ß–¢–û –£–ñ–ï –°–î–ï–õ–ê–ù–û:

1. ‚úÖ –°–æ–∑–¥–∞–Ω—ã –≤—Å–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:
   - `/var/www/messenger/backend/uploads/images/`
   - `/var/www/messenger/backend/uploads/audio/`
   - `/var/www/messenger/backend/uploads/videos/`
   - `/var/www/messenger/backend/uploads/documents/`

2. ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∞ 777 –¥–ª—è –≤—Å–µ—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

3. ‚úÖ –°–æ–∑–¥–∞–Ω —Å–∏–º–ª–∏–Ω–∫:
   ```
   /var/www/messager/backend/uploads ‚Üí /var/www/messenger/backend/uploads
   ```

4. ‚úÖ Backend —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç root (PID: 86106)

5. ‚úÖ –†–æ—É—Ç—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã:
   - `POST /api/messages/upload-audio`
   - `POST /api/messages/upload-image`
   - `POST /api/messages/upload-video`
   - `POST /api/messages/upload-document`

6. ‚úÖ Nginx –Ω–∞—Å—Ç—Ä–æ–µ–Ω:
   ```nginx
   location /uploads {
       alias /var/www/messager/backend/uploads;
       expires 1y;
       add_header Cache-Control "public";
   }
   ```

---

## üîç –ß–¢–û –ù–£–ñ–ù–û –ü–†–û–í–ï–†–ò–¢–¨:

### 1. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–∞–π–ª:

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://neekloai.ru
2. **–û—á–∏—Å—Ç–∏—Ç–µ –∫–µ—à**: `Ctrl + F5` –∏–ª–∏ –∏–Ω–∫–æ–≥–Ω–∏—Ç–æ
3. –û—Ç–∫—Ä–æ–π—Ç–µ —á–∞—Ç
4. –û—Ç–ø—Ä–∞–≤—å—Ç–µ:
   - üé§ –ì–æ–ª–æ—Å–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
   - üì∑ –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
   - üé• –í–∏–¥–µ–æ

### 2. –ü—Ä–æ–≤–µ—Ä–∏–º –ª–æ–≥–∏ backend –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh root@89.169.39.244

# –°–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏
pm2 logs messenger-api --lines 0

# –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ñ–∞–π–ª –∏ —Å–º–æ—Ç—Ä–∏—Ç–µ —á—Ç–æ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –≤ –ª–æ–≥–∞—Ö
```

**–ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ –ª–æ–≥–∞—Ö**:
- ‚úÖ –ó–∞–ø—Ä–æ—Å `POST /api/messages/upload-image` (–∏–ª–∏ audio/video)
- ‚úÖ –°—Ç–∞—Ç—É—Å 200 –∏–ª–∏ 201 (—É—Å–ø–µ—Ö)
- ‚ùå –û—à–∏–±–∫–∏ (Error, Exception, Failed)
- ‚ùå 4xx –∏–ª–∏ 5xx —Å—Ç–∞—Ç—É—Å—ã

### 3. –ü—Ä–æ–≤–µ—Ä–∏–º —á—Ç–æ —Ñ–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–∏–ª—Å—è:

```bash
ssh root@89.169.39.244

# –°—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª–∞:
ls -la /var/www/messenger/backend/uploads/images/
ls -la /var/www/messenger/backend/uploads/audio/
ls -la /var/www/messenger/backend/uploads/videos/
```

**–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å**:
```
-rw-r--r-- 1 root root 12345 Jan 31 20:15 img-1769879074078-989034049.jpg
-rw-r--r-- 1 root root 54321 Jan 31 20:15 voice-1769879003289-390585309.webm
```

–ï—Å–ª–∏ —Ñ–∞–π–ª **–ù–ï–¢** ‚Üí –ø—Ä–æ–±–ª–µ–º–∞ –≤ backend (—Ñ–∞–π–ª –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è)  
–ï—Å–ª–∏ —Ñ–∞–π–ª **–ï–°–¢–¨** ‚Üí –ø—Ä–æ–±–ª–µ–º–∞ –≤ Nginx –∏–ª–∏ —Å–∏–º–ª–∏–Ω–∫–µ (—Ñ–∞–π–ª –Ω–µ –æ—Ç–¥–∞—ë—Ç—Å—è)

### 4. –ü—Ä–æ–≤–µ—Ä–∏–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ Nginx:

```bash
# –ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–∞–π–ª–∞, —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏–º—è —Ñ–∞–π–ª–∞ –∏–∑ –ª–æ–≥–æ–≤/UI
# –ù–∞–ø—Ä–∏–º–µ—Ä: img-1769879074078-989034049.jpg

curl -I https://neekloai.ru/uploads/images/img-1769879074078-989034049.jpg
```

**–î–æ–ª–∂–Ω–æ –±—ã—Ç—å**:
```
HTTP/2 200 
content-type: image/jpeg
content-length: 12345
```

**–ï—Å–ª–∏ 404**:
```
HTTP/2 404 
```
‚Üí –§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω —á–µ—Ä–µ–∑ Nginx (–ø—Ä–æ–±–ª–µ–º–∞ —Å –ø—É—Ç—ë–º –∏–ª–∏ —Å–∏–º–ª–∏–Ω–∫–æ–º)

---

## üîß –í–û–ó–ú–û–ñ–ù–´–ï –ü–†–ò–ß–ò–ù–´:

### –ü—Ä–∏—á–∏–Ω–∞ 1: –§–∞–π–ª –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
**–°–∏–º–ø—Ç–æ–º—ã**: –ù–µ—Ç —Ñ–∞–π–ª–∞ –≤ `/var/www/messenger/backend/uploads/`

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
```bash
# –õ–æ–≥–∏ backend –≤–æ –≤—Ä–µ–º—è –æ—Ç–ø—Ä–∞–≤–∫–∏
pm2 logs messenger-api --lines 50 | grep -i error
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏**:
- –ù–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –∑–∞–ø–∏—Å—å
- –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- Multer –Ω–µ –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª

**–†–µ—à–µ–Ω–∏–µ**:
```bash
chmod 777 /var/www/messenger/backend/uploads/*
chown -R root:root /var/www/messenger/backend/uploads
```

### –ü—Ä–∏—á–∏–Ω–∞ 2: –°–∏–º–ª–∏–Ω–∫ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
**–°–∏–º–ø—Ç–æ–º—ã**: –§–∞–π–ª –µ—Å—Ç—å –≤ `/var/www/messenger/`, –Ω–æ 404 —á–µ—Ä–µ–∑ Nginx

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
```bash
ls -la /var/www/messager/backend/uploads/
# –î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–∏–º–ª–∏–Ω–∫:
# lrwxrwxrwx 1 root root 34 ... uploads -> /var/www/messenger/backend/uploads

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ —Å–∏–º–ª–∏–Ω–∫ —Ä–∞–±–æ—á–∏–π:
ls -la /var/www/messager/backend/uploads/images/
```

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å —Å–∏–º–ª–∏–Ω–∫
rm /var/www/messager/backend/uploads
ln -s /var/www/messenger/backend/uploads /var/www/messager/backend/uploads
```

### –ü—Ä–∏—á–∏–Ω–∞ 3: Nginx –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
**–°–∏–º–ø—Ç–æ–º—ã**: –§–∞–π–ª –µ—Å—Ç—å, —Å–∏–º–ª–∏–Ω–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ 404

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥–∞ Nginx
sudo nginx -t

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ Nginx –≤–∏–¥–∏—Ç —Ñ–∞–π–ª
sudo -u www-data ls /var/www/messager/backend/uploads/images/
```

**–†–µ—à–µ–Ω–∏–µ**:
```bash
# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ Nginx
sudo systemctl reload nginx
```

### –ü—Ä–∏—á–∏–Ω–∞ 4: Frontend –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å
**–°–∏–º–ø—Ç–æ–º—ã**: Backend —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ–∞–π–ª, –Ω–æ frontend –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ DevTools (F12 ‚Üí Network)**:
- –ù–∞–π–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å `POST /api/messages/upload-image`
- –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ **Response** (–æ—Ç–≤–µ—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞)
- –î–æ–ª–∂–µ–Ω –±—ã—Ç—å `{ "message": {...}, "mediaUrl": "/uploads/images/img-*.jpg" }`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ frontend –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç–æ—Ç URL

**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥ frontend, —á—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `mediaUrl` –∏–∑ –æ—Ç–≤–µ—Ç–∞

---

## üìä –ü–û–®–ê–ì–û–í–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê:

### –®–∞–≥ 1: –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
```bash
ssh root@89.169.39.244
```

### –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤
```bash
pm2 logs messenger-api --lines 0
```

### –®–∞–≥ 3: –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ñ–∞–π–ª —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

### –®–∞–≥ 4: –°–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏
**–ß—Ç–æ –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è**:
```
POST /api/messages/upload-image 200 125ms
```

**–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ –æ—à–∏–±–∫—É**:
```
POST /api/messages/upload-image 500 Internal Server Error
Error: ENOENT: no such file or directory
```
‚Üí –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

**–ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è**:
‚Üí –ó–∞–ø—Ä–æ—Å –Ω–µ –¥–æ—Ö–æ–¥–∏—Ç –¥–æ backend

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª
```bash
ls -la /var/www/messenger/backend/uploads/images/ | tail -5
```

**–ï—Å–ª–∏ —Ñ–∞–π–ª–∞ –ù–ï–¢**:
‚Üí Backend –Ω–µ —Å–æ—Ö—Ä–∞–Ω–∏–ª —Ñ–∞–π–ª (–ø—Ä–æ–±–ª–µ–º–∞ —Å –ø—Ä–∞–≤–∞–º–∏ –∏–ª–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–µ–π)

**–ï—Å–ª–∏ —Ñ–∞–π–ª –ï–°–¢–¨**:
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á–µ—Ä–µ–∑ Nginx
curl -I https://neekloai.ru/uploads/images/[–ò–ú–Ø_–§–ê–ô–õ–ê]
```

---

## üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò:

1. **–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–∞–π–ª** (–≥–æ–ª–æ—Å–æ–≤–æ–µ, —Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ)
2. **–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ª–æ–≥–∏ backend** (—á—Ç–æ –ø–æ—è–≤–∏–ª–æ—Å—å –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏)
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ** (–µ—Å—Ç—å –ª–∏ –æ–Ω –≤ uploads)
4. **–°–æ–æ–±—â–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã**:
   - –ï—Å—Ç—å –ª–∏ –æ—à–∏–±–∫–∏ –≤ –ª–æ–≥–∞—Ö?
   - –°–æ—Ö—Ä–∞–Ω–∏–ª—Å—è –ª–∏ —Ñ–∞–π–ª?
   - –ö–∞–∫–æ–π —Å—Ç–∞—Ç—É—Å –∫–æ–¥ –≤ –±—Ä–∞—É–∑–µ—Ä–µ (200, 404, 500)?

---

## ‚úÖ –ü–û–°–õ–ï –î–ò–ê–ì–ù–û–°–¢–ò–ö–ò:

–ö–æ–≥–¥–∞ —É–∑–Ω–∞–µ–º —Ç–æ—á–Ω—É—é –ø—Ä–∏—á–∏–Ω—É, –∏—Å–ø—Ä–∞–≤–∏–º:
- –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å –ø—Ä–∞–≤–∞–º–∏ ‚Üí chmod/chown
- –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–µ–π ‚Üí mkdir
- –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å Nginx ‚Üí –∏—Å–ø—Ä–∞–≤–∏–º –∫–æ–Ω—Ñ–∏–≥
- –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å frontend ‚Üí –∏—Å–ø—Ä–∞–≤–∏–º –∫–æ–¥

---

**üîç –ü–û–ü–†–û–ë–£–ô–¢–ï –û–¢–ü–†–ê–í–ò–¢–¨ –§–ê–ô–õ –ò –°–û–û–ë–©–ò–¢–ï –ß–¢–û –ü–û–ö–ê–ó–´–í–ê–Æ–¢ –õ–û–ì–ò!**
