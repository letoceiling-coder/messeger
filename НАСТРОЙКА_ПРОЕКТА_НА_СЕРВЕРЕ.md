# –ù–ê–°–¢–†–û–ô–ö–ê –ü–†–û–ï–ö–¢–ê –ù–ê –°–ï–†–í–ï–†–ï

## üìÅ –°–¢–†–£–ö–¢–£–†–ê –†–ê–ó–ú–ï–©–ï–ù–ò–Ø

### –ü–æ—á–µ–º—É –¥–≤–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏?

**`~/messager/`** - —Ä–∞–±–æ—á–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è:
- –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ Backend –∏ Frontend
- –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —Å–±–æ—Ä–∫–∏
- –ù–µ –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ –≤–µ–±

**`~/parser-auto.site-access.ru/public_html/`** - –ø—É–±–ª–∏—á–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è:
- –¢–æ–ª—å–∫–æ —Å–æ–±—Ä–∞–Ω–Ω—ã–π Frontend (build)
- –î–æ—Å—Ç—É–ø–Ω–∞ –ø–æ –¥–æ–º–µ–Ω—É `https://parser-auto.siteaccess.ru/`
- –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –¥–ª—è –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞

---

## üöÄ –ù–ê–°–¢–†–û–ô–ö–ê BACKEND

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
ssh dsc23ytp@5.101.156.207
cd ~/messager/backend

# –°–æ–∑–¥–∞—Ç—å .env.production
cp .env.production.example .env.production
nano .env.production
# –ó–∞–ø–æ–ª–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è:
# DATABASE_URL=postgresql://...
# JWT_SECRET=...
# REDIS_URL=redis://localhost:6379
# TELEGRAM_BOT_TOKEN=...
# CORS_ORIGIN=https://parser-auto.siteaccess.ru

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install --production

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Prisma Client
npx prisma generate

# –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î
npx prisma migrate deploy

# –°–±–æ—Ä–∫–∞
npm run build

# –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
mkdir -p uploads/audio logs

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å PM2
npm install -g pm2

# –ó–∞–ø—É—Å—Ç–∏—Ç—å
pm2 start ecosystem.config.js
pm2 save
pm2 startup
```

---

## üé® –ù–ê–°–¢–†–û–ô–ö–ê FRONTEND

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
cd ~/messager/frontend-web

# –°–æ–∑–¥–∞—Ç—å .env.production
cp .env.production.example .env.production
nano .env.production
# –ó–∞–ø–æ–ª–Ω–∏—Ç—å:
# VITE_API_URL=https://parser-auto.siteaccess.ru/api
# VITE_WS_URL=wss://parser-auto.siteaccess.ru

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
npm install

# –°–±–æ—Ä–∫–∞
npm run build

# –†–∞–∑–º–µ—Å—Ç–∏—Ç—å build –≤ public_html
cp -r dist/* ~/parser-auto.site-access.ru/public_html/
```

---

## üåê –ù–ê–°–¢–†–û–ô–ö–ê NGINX

### –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:

```bash
sudo nano /etc/nginx/sites-available/parser-auto
```

–î–æ–±–∞–≤–∏—Ç—å (–∑–∞–º–µ–Ω–∏—Ç–µ –¥–æ–º–µ–Ω—ã –Ω–∞ –≤–∞—à–∏):

```nginx
server {
    listen 80;
    server_name parser-auto.siteaccess.ru;
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name parser-auto.siteaccess.ru;

    root /home/dsc23ytp/parser-auto.site-access.ru/public_html;
    index index.html;

    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;

    # Frontend
    location / {
        try_files $uri $uri/ /index.html;
    }

    # Backend API
    location /api {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # WebSocket
    location /socket.io/ {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        proxy_set_header Host $host;
    }
}
```

–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å:

```bash
sudo ln -s /etc/nginx/sites-available/parser-auto /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

---

## ‚úÖ –ü–†–û–í–ï–†–ö–ê

### Backend:

```bash
curl http://localhost:3000/health
```

### Frontend:

–û—Ç–∫—Ä–æ–π—Ç–µ: `https://parser-auto.siteaccess.ru/`

### PM2:

```bash
pm2 status
pm2 logs messager-backend
```

---

## üìã –ò–¢–û–ì–û–í–ê–Ø –°–¢–†–£–ö–¢–£–†–ê

```
~/messager/backend/              ‚Üí Backend (–ø–æ—Ä—Ç 3000)
~/messager/frontend-web/         ‚Üí Frontend –∏—Å—Ö–æ–¥–Ω–∏–∫–∏
~/parser-auto.site-access.ru/public_html/  ‚Üí Frontend build (–≤–µ–±-—Å–µ—Ä–≤–µ—Ä)
```

**–î–æ–º–µ–Ω:** `https://parser-auto.siteaccess.ru/` ‚Üí `public_html/`
**API:** `https://parser-auto.siteaccess.ru/api` ‚Üí `localhost:3000`
